#!/usr/bin/env python3

import requests
import re

HOST = 'http://mercury.picoctf.net:5080/'

def get_part_of_flag(text, pattern):
    result = re.search(pattern, text)
    if result:
        return result.group()
    else:
        return "NOT_FOUND"

flag = ""

resp = requests.get(HOST)
flag += get_part_of_flag(resp.text, 'picoCTF\{\S*')

resp = requests.get(f"{HOST}mycss.css")
flag += get_part_of_flag(resp.text, '\S*?_\S*?_\S*')

resp = requests.get(f"{HOST}robots.txt")
flag += get_part_of_flag(resp.text, '\S*?_\S*?_\S*')

resp = requests.get(f"{HOST}.htaccess")
flag += get_part_of_flag(resp.text, '\S*?_\S*?_\S*')

resp = requests.get(f"{HOST}.DS_Store")
flag += get_part_of_flag(resp.text, '_\S*?\}')

print(flag)
